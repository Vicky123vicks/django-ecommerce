{% load static %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
<script src="{% static 'js/theme.js' %}"></script>

<a href="{% url 'ecommerce' %}">
<img src="{% static product.image %}" alt="{{ product.name }}">


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>VinKart</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <script src="{% static 'js/theme.js' %}"></script>
</head>
<body>

    <!-- Website Title -->
    <div class="site-title">
        <h1>VinKart</h1>
    </div>

    <!-- Navbar -->
    <!-- âœ… Updated Navbar -->
<div class="navbar">
    <div class="nav-links">
        <a href="{% url 'ecommerce' %}">Home</a>

        <div class="dropdown">
    <a href="#">Categories</a>
    <ul class="dropdown-content">
        <li><a href="?category=all{% if search_query %}&query={{ search_query }}{% endif %}">All</a></li>
        <li><a href="?category=Electronics{% if search_query %}&query={{ search_query }}{% endif %}">Electronics</a></li>
        <li><a href="?category=Furniture{% if search_query %}&query={{ search_query }}{% endif %}">Furniture</a></li>
        <li><a href="?category=Shoes - Casual{% if search_query %}&query={{ search_query }}{% endif %}">Shoes - Casual</a></li>
        <li><a href="?category=Shoes - Formal{% if search_query %}&query={{ search_query }}{% endif %}">Shoes - Formal</a></li>
        <li><a href="?category=Dress - Men{% if search_query %}&query={{ search_query }}{% endif %}">Dress - Men</a></li>
        <li><a href="?category=Dress - Women{% if search_query %}&query={{ search_query }}{% endif %}">Dress - Women</a></li>
        <li><a href="?category=Household Items{% if search_query %}&query={{ search_query }}{% endif %}">Household Items</a></li>
    </ul>
</div>


        <a href="#">Account</a>
        <a href="{% url 'cart' %}">Cart ({{ cart_count }})</a>

        <!-- ðŸŒ™ Light/Dark Theme Toggle -->
        <label class="theme-switch">
            <input type="checkbox" id="theme-toggle" onclick="toggleTheme()">
            <span class="slider"></span>
        </label>

        <a href="{% url 'logout' %}" class="logout-link">Logout</a>
    </div>
</div>


    <!-- Welcome and Search -->
    <div class="welcome">
        <h2>
            Welcome,
            {% if request.session.user %}
                {{ request.session.user }}!
            {% elif request.user.is_authenticated %}
                {{ request.user.username }}!
            {% else %}
                Guest!
            {% endif %}
        </h2>
    </div>

    <div class="search-bar">
        <form method="GET" action="">
            <input type="text" name="query" value="{{ search_query }}" placeholder="Search products...">
            <input type="hidden" name="category" value="{{ selected_category }}">
            <button type="submit">Search</button>
        </form>
    </div>

   
   <!-- Product Cards -->
<div class="product-container">
  {% if products %}
    {% for product in products %}
      <div class="product-card">
        <a href="{% url 'product_detail' product.id %}">
          <img src="{% static product.image %}" alt="{{ product.name }}" class="product-image">
        </a>
        <div class="product-title">
          <a href="{% url 'product_detail' product.id %}">{{ product.name }}</a>
        </div>
        <div class="product-price">Price: â‚¹{{ product.price }}</div>
        <form method="POST" action="{% url 'add_to_cart' product.id %}">
          {% csrf_token %}
          <button type="submit" class="btn btn-add">Add to Cart</button>
        </form>
      </div>
    {% endfor %}
  {% else %}
    <p>No products found for your search.</p>
  {% endif %}
</div>


    <!-- Dark mode script -->
    <script>
    function toggleTheme() {
        document.body.classList.toggle("dark-mode");
        localStorage.setItem("theme", document.body.classList.contains("dark-mode") ? "dark" : "light");
    }

    window.onload = function () {
        if (localStorage.getItem("theme") === "dark") {
            document.body.classList.add("dark-mode");
            document.getElementById("theme-toggle").checked = true;
        }
    };
</script>

</body>
</html>